# üåº Flower Retrieval System

–°–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ü–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

| –ü–æ–¥—Ö–æ–¥                  | ResNet50 | EfficientNet-B0 | CLIP (zero-shot) | CLIP (fine-tuned) | Metric Learning | DINOv2 |
|-------------------------|---------:|----------------:|-----------------:|------------------:|----------------:|--------:|
| **–ú–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞**        | FAISS Flat | FAISS Flat    | FAISS Flat       | FAISS Flat        | FAISS Flat      | FAISS Flat |
| **Precision@5**         | 0.926    | 0.938           | 0.548            | 0.331             | 0.903               | 0.974   |
| **mAP@5**               | 0.826    | 0.895           | 0.279            | 0.238             | 0.835           | 0.869   |

> *–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —á–∞—Å—Ç–∏ Flowers Recognition (‚âà800√ó5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π). ¬´‚Äì¬ª –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Precision@5 –¥–ª—è Metric Learning.*
![–ü—Ä–∏–º–µ—Ä UI](demo.png)
---

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**  
   ```bash
   git clone <repo_url>
   cd <repo_folder>
   ```
2. C–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç —Å kaggle –∏ –ø–æ–ª–æ–∂–∏—Ç—å –≤ flowers –≤—Å–µ 5 –ø–∞–ø–æ–∫ –∫–ª–∞—Å—Å–æ–≤

3. –°–∫–∞—á–∞—Ç—å –≤–µ—Å–∞ –∏ –ø—É—Ç–∏: https://drive.google.com/drive/folders/1GFZ-g1qytLQ6ay2uXyP8ByrHG4T9dR0B?usp=sharing
   –ò –ø–æ–ª–æ–∂–∏—Ç—å –ø–∞–ø–∫—É models –≤ –∫–æ—Ä–µ–Ω—å

2. **–°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**  
   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**  
   ```bash
   pip install -r requirements.txt
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å API (FastAPI + Uvicorn)**  
   ```bash
   python3 -m app.main
   ```
   API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É http://localhost:8080

5. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Streamlit)**  
   ```bash
   streamlit run improved_streamlit.py        --server.port 8501        --server.address 0.0.0.0
   ```
   –û—Ç–∫—Ä—ã—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:8501
–ù–∞ UI –º–æ–∂–µ—Ç –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –≤—ã–¥–∞—Ç—å –Ω–µ—Ö–≤–∞—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–æ–∏—Å–∫–∞ –Ω–µ —É—Å–ø–µ–ª –ø–æ—Ñ–∏–∫—Å–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–∞–∂–∞—Ç—å
–õ—É—á—à–∏–µ –º–æ–¥–µ–ª–∏: DINO, METRIC
---

## –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

1. **–°–æ–±—Ä–∞—Ç—å –∏ –ø–æ–¥–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã**  
   ```bash
   docker-compose up --build -d
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã**  
   - API: http://localhost:8080/models  
   - UI:  http://localhost:8501  

–ù–∞ –¥–æ–∫–µ—Ä–µ –Ω–∞ UI –º–æ–∂–µ—Ç –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –≤—ã–¥–∞—Ç—å –Ω–µ—Ö–≤–∞—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–æ–∏—Å–∫–∞ –Ω–µ —É—Å–ø–µ–ª –ø–æ—Ñ–∏–∫—Å–∏—Ç—å
–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Metric –∏ –æ–±—Ä–∞—Ç–Ω–æ –æ–Ω–æ –ø—Ä–æ—Å—Ç–æ –¥–æ–ª–≥–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ—â–µ –≤–µ—Å–∞ dino –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ —á—É—Ç—å –ø–æ–¥–æ–∂–¥–∞—Ç—å/–ø–∞—Ä—É —Ä–∞–∑ –Ω–∞–∂–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∏–¥–µ—Ç—Å—è –ø–æ—Ç–æ–º —Ö–æ—Ä–æ—à–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py         # REST API (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ registry.py     # –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π –∏ –∏–Ω–¥–µ–∫—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ utils.py        # –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ extractors.py   # –∫–ª–∞—Å—Å—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ mixin.py        # –æ–±—â–∏–µ –º–∏–∫—Å–∏–Ω—ã –¥–ª—è fine-tune
‚îú‚îÄ‚îÄ models/             # –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã: –∏–Ω–¥–µ–∫—Å—ã, –≤–µ—Å–∞, –ø—É—Ç–∏, meta
‚îú‚îÄ‚îÄ improved_streamlit.py  # –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Streamlit)
‚îú‚îÄ‚îÄ exper.ipynb       # –Ω–æ—É—Ç–±—É–∫
‚îú‚îÄ‚îÄ longstoryshort.docx #—á—Ç–æ –∫–∞–∫ –ø—Ä–æ–±–æ–≤–∞–ª —Ñ—É–ª—Å—Ç–æ—Ä–∏ —Ç–µ—Å—Ç–≤–æ–≥–æ —á–∏—Ç–∞—Ç—å!!!
‚îú‚îÄ‚îÄ config.yaml        # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt   # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ Dockerfile         # —Å–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
‚îú‚îÄ‚îÄ docker-compose.yml # –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Docker Compose
‚îî‚îÄ‚îÄ README.md          # –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

##  API Endpoints

- **GET /models**  
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.  
  **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
  ```json
  { "models": ["resnet50","efficientnet_b0","dinov2", "metric"] }
  ```

- **POST /predict?model={model_name}**  
  –ò—â–µ—Ç top-5 –ø–æ—Ö–æ–∂–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.  
  - **file** (multipart/form-data): –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ  
  - **model** (query): –∏–º—è –º–æ–¥–µ–ª–∏ –∏–∑ `/models`

  **–£—Å–ø–µ—Ö (200)**:
  ```json
  {
    "model": "resnet50",
    "results": [
      { "image_path": "flowers/rose/img1.jpg", "similarity": 0.983 }
    ]
  }
  ```
  **–û—à–∏–±–∫–∏**:  
  - 404 ‚Äî –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –º–æ–¥–µ–ª—å  
  - 500 ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

---

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- **FastAPI** + **Uvicorn** –¥–ª—è REST API  
- **Streamlit** –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞  
- **FAISS** (Flat/IP) –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –≤–µ–∫—Ç–æ—Ä–∞–º  
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–¥–µ–ª–µ–π: ResNet50, EfficientNet-B0, CLIP, Metric Learning, DINOv2  
- **Docker** + **docker-compose** –¥–ª—è –ª—ë–≥–∫–æ–≥–æ –¥–µ–ø–ª–æ—è  
- –í—Å–µ RNG-—Å–µ–º–µ–Ω–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏  

---

